survey = "acs5"
)
# Clean the county names to remove state name and "County"
data_working <- data %>%
mutate(new_name = str_remove(NAME, " County, West Virginia")) %>%
select(!NAME)
# Hint: use mutate() with str_remove()
# Display the first few rows
head(data_working)
# Calculate MOE percentage and reliability categories using mutate()
data_working <- data_working %>%
mutate(POP_MOE_Per = (total_populationM/total_populationE)*100,
INC_MOE_Per = (median_hh_incomeM/median_hh_incomeE)*100,
POP_reliability = case_when(
POP_MOE_Per < 5 ~ "High Confidence",
POP_MOE_Per > 10 ~ "Low Confidence",
.default = "Moderate Confidence"),
INC_reliability = case_when(
INC_MOE_Per < 5 ~ "High Confidence",
INC_MOE_Per > 10 ~ "Low Confidence",
.default = "Moderate Confidence")
)
# Create a summary showing count of counties in each reliability category
POP_reliability_county <- data_working %>%
group_by(POP_reliability) %>%
count()
POP_reliability_county
INC_reliability_county <- data_working %>%
group_by(INC_reliability) %>%
count()
INC_reliability_county
# Hint: use count() and mutate() to add percentages
# Create table of top 5 counties by MOE percentage
Highest_Inc_MOE_counties <- data_working %>%
arrange(desc(INC_MOE_Per)) %>%
slice(1:5) %>%
select(new_name, median_hh_incomeE, median_hh_incomeM, INC_MOE_Per, INC_reliability)
# Format as table with kable() - include appropriate column names and caption
kable(Highest_Inc_MOE_counties,
col.names = c("County", "Median Household Income", "Margin of Error", "Percentage Margin of Error", "Reliability Category"),
caption = "Five Highest Margin of Errors for Income Estimates Among West Virginia Counties"
)
View(data_working)
filter(new_name %in% c("Jefferson", "Kanawha", "Lewis")
selected_counties <- data_working %>%
# Use filter() to select 2-3 counties from your county_reliability data
# Store the selected counties in a variable called selected_counties
selected_counties <- data_working %>%
filter(new_name %in% c("Jefferson", "Kanawha", "Lewis"))
# Display the selected counties with their key characteristics
# Show: county name, median income, MOE percentage, reliability category
View(selected_counties)
selected_counties <- selected_counties %>%
select(new_name, median_hh_incomeE, INC_MOE_Per, INC_reliability)
kable(selected_counties,
col.names = c("County", "Median Household Income,", "Margin of Error", "Reliability Category"),
caption = "Selected Counties and Associated Median Household Incomes")
View(selected_counties)
View(data_working)
tract_analysis <- get_acs(
geography = "tract",
variables = c(
White_Alone = "B03002_003",
Black_African_American = "B03002_004",
Hispanic_Latino = "B03002_012",
Total_Population = "B03002_991"
),
county = c(
"54037",
"54039",
"54041"
),
year = 2023
)
tract_analysis <- get_acs(
geography = "tract",
variables = c(
White_Alone = "B03002_003",
Black_African_American = "B03002_004",
Hispanic_Latino = "B03002_012",
Total_Population = "B03002_001"
),
state = "54",
county = c(
"037",
"039",
"041"
),
year = 2023
)
View(tract_analysis)
tract_analysis <- get_acs(
geography = "tract",
variables = c(
White_Alone = "B03002_003",
Black_African_American = "B03002_004",
Hispanic_Latino = "B03002_012",
Total_Population = "B03002_001"
),
state = "54",
county = c(
"037",
"039",
"041"
),
year = 2023,
output = "wide"
)
View(tract_analysis)
tract_analysis <- tract_analysis %>%
muate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
) %>%
str_remove(county, " West Virginia")
tract_analysis <- tract_analysis %>%
muate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
)
tract_analysis <- tract_analysis %>%
mutate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
)
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
) %>%
str_remove(county, "; West Virginia") %>%
select(!"NAME")
tract_analysis <- tract_analysis %>%
select(!"NAME")
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
) %>%
str_remove(county, "; West Virginia")
tract_analysis <- tract_analysis %>%
str_remove(county, "; West Virgnia") %>%
str_remove(census_tract, "Census Tract ")
tract_analysis <- tract_analysis %>%
mutate(
county = str_remove(county, "; West Virgnia") %>%
census_tract = str_remove(census_tract, "Census Tract ")
tract_analysis <- tract_analysis %>%
mutate(
county = str_remove(county, "; West Virgnia"),
census_tract = str_remove(census_tract, "Census Tract ")
)
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(
county = str_remove(county, "; West Virginia"),
census_tract = str_remove(census_tract, "Census Tract ")
)
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(
county = str_remove(county, "County; West Virginia"),
census_tract = str_remove(census_tract, "Census Tract ")
)
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(county = str_remove(" County"))
tract_analysis <- tract_analysis %>%
mutate(county = str_remove(county, " County"))
View(tract_analysis)
tract_analysis <- tract_analysis %>%
mutate(Per_White = White_AloneE / Total_PopulationE,
Per_Black = Black_African_AmericanE / Total_PopulationE,
Per_Hispanic = Hispanic_LatinoE / Total_PopulationE)
highest_hispanic <- tract_analysis %>%
arrange(desc(Per_Hispanic)) %>%
slice(1:5)
View(highest_hispanic)
county_demographics <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(White_AloneE)/sum(Total_PopulationE)
)
View(county_demographics)
table <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(White_AloneE)/sum(Total_PopulationE)
) %>%
count(census_tract)
county_demographics <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE)
)
View(county_demographics)
table <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(White_AloneE)/sum(Total_PopulationE),
Tracts = n()
)
View(table)
kable(table,
col.names = c("County", "Percent Black", "Percent White", "Percent Hispanic", "Number of Census Tracts"),
caption = "Demographic Information at County Level, West Virginia")
MOE_analysis <- tract_analysis %>%
mutate(WhiteMOE = (White_AloneM/White_AloneE)*100,
BlackMOE = (Black_African_AmericanM/Black_African_AmericanE)*100,
HispanicMOE = (Hispanic_LatinoM/Hispanic_LatinoE)*100
)
View(MOE_analysis)
MOE_analysis <- MOE_analysis %>%
mutate(Quality = if_else(
WhiteMOE > 10 | BlackMOE > 10 | HispanicMOE >10,
"Low Quality",
"Fine"
))
MOE_summary <- MOE_analysis %>%
filter(Quality %in% "Low Quality") %>%
n()
MOE_summary <- MOE_analysis %>%
filter(Quality %in% "Low Quality") %>%
count()
View(MOE_summary)
MOE_analysis <- MOE_analysis %>%
mutate(Quality = case_when(
WhiteMOE > 20 | BlackMOE > 10 | HispanicMOE >10 ~ "Very Low Quality",
WhiteMOE < 10 | BlackMOE < 10 | HispanicMOE < 10 ~ "Fine",
"Low Quality"
))
MOE_analysis <- MOE_analysis %>%
mutate(Quality = case_when(
WhiteMOE > 20 | BlackMOE > 10 | HispanicMOE >10 ~ "Very Low Quality",
WhiteMOE < 10 | BlackMOE < 10 | HispanicMOE < 10 ~ "Fine",
.default = "Low Quality"
))
MOE_summary <- MOE_analysis %>%
filter(Quality %in% "Low Quality") %>%
count()
MOE_sumamry <- group_by(Quality) %>%
n()
MOE_sumamry <- group_by(Quality) %>%
count()
MOE_sumamry <- group_by(Quality) %>%
tally()
MOE_sumamry <- MOE_analysis %>%
group_by(Quality) %>%
tally()
MOE_sumamry <- MOE_analysis %>%
group_by(Quality)
MOE_sumamry <- MOE_analysis %>%
group_by(Quality) %>%
count()
MOE_sumamry <- MOE_analysis %>%
count(Quality)
MOE_sumamry <- MOE_analysis %>%
count(Quality)
Poor_Quality <- MOE_analysis %>%
filter(Quality %in% c("Low Quality", "Low"))
Poor_Quality <- MOE_analysis %>%
filter(Quality %in% c("Low Quality", "Low")) %>%
count()
View(Poor_Quality)
Poor_Quality <- MOE_analysis %>%
filter(Quality %in% c("Low Quality", "Low")) %>%
tally()
Poor_Quality <- MOE_analysis %>%
filter(Quality %in% c("Low Quality", "Low")) %>%
nrow()
Poor_Quality <- MOE_analysis %>%
filter(Quality %in% c("Low Quality", "Low"))
MOE_analysis %>% count(Quality)
MOE_Table <- MOE_analysis %>%
group_by(Quality) %>%
summarize(average_population = mean(populaiton),
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE))
MOE_Table <- MOE_analysis %>%
group_by(Quality) %>%
summarize(average_population = mean(population),
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE))
View(MOE_Table)
MOE_Table <- MOE_analysis %>%
group_by(Quality) %>%
summarize(average_population = mean(Total_PopulationE),
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE))
# Load required packages (hint: you need tidycensus, tidyverse, and knitr)
library(tidycensus)
library(tidyverse)
library(knitr)
# Set your Census API key
census_api_key("459aac3635030875e83d67456e41ee620321ed9e", install = TRUE)
# Load required packages (hint: you need tidycensus, tidyverse, and knitr)
library(tidycensus)
library(tidyverse)
library(knitr)
# Set your Census API key
#census_api_key("459aac3635030875e83d67456e41ee620321ed9e", install = TRUE)
# Choose your state for analysis - assign it to a variable called my_state
my_state <- c("West Virginia")
# Write your get_acs() code here
data <- get_acs(
geography = "county",
variables = c(
median_hh_income = "B19013_001",
total_population = "B01003_001"),
state = "WV",
year = 2022,
output = "wide",
survey = "acs5"
)
# Clean the county names to remove state name and "County"
data_working <- data %>%
mutate(new_name = str_remove(NAME, " County, West Virginia")) %>%
select(!NAME)
# Hint: use mutate() with str_remove()
# Display the first few rows
head(data_working)
# Calculate MOE percentage and reliability categories using mutate()
data_working <- data_working %>%
mutate(POP_MOE_Per = (total_populationM/total_populationE)*100,
INC_MOE_Per = (median_hh_incomeM/median_hh_incomeE)*100,
POP_reliability = case_when(
POP_MOE_Per < 5 ~ "High Confidence",
POP_MOE_Per > 10 ~ "Low Confidence",
.default = "Moderate Confidence"),
INC_reliability = case_when(
INC_MOE_Per < 5 ~ "High Confidence",
INC_MOE_Per > 10 ~ "Low Confidence",
.default = "Moderate Confidence")
)
# Create a summary showing count of counties in each reliability category
POP_reliability_county <- data_working %>%
group_by(POP_reliability) %>%
count()
POP_reliability_county
INC_reliability_county <- data_working %>%
group_by(INC_reliability) %>%
count()
INC_reliability_county
# Hint: use count() and mutate() to add percentages
# Create table of top 5 counties by MOE percentage
Highest_Inc_MOE_counties <- data_working %>%
arrange(desc(INC_MOE_Per)) %>%
slice(1:5) %>%
select(new_name, median_hh_incomeE, median_hh_incomeM, INC_MOE_Per, INC_reliability)
# Format as table with kable() - include appropriate column names and caption
kable(Highest_Inc_MOE_counties,
col.names = c("County", "Median Household Income", "Margin of Error", "Percentage Margin of Error", "Reliability Category"),
caption = "Five Highest Margin of Errors for Income Estimates Among West Virginia Counties"
)
# Use filter() to select 2-3 counties from your county_reliability data
# Store the selected counties in a variable called selected_counties
selected_counties <- data_working %>%
filter(new_name %in% c("Jefferson", "Kanawha", "Lewis"))
# Display the selected counties with their key characteristics
# Show: county name, median income, MOE percentage, reliability category
selected_counties <- selected_counties %>%
select(new_name, median_hh_incomeE, INC_MOE_Per, INC_reliability)
kable(selected_counties,
col.names = c("County", "Median Household Income,", "Margin of Error", "Reliability Category"),
caption = "Selected Counties and Associated Median Household Incomes")
# Define your race/ethnicity variables with descriptive names
# Use get_acs() to retrieve tract-level data
# Hint: You may need to specify county codes in the county parameter
# Calculate percentage of each group using mutate()
# Create percentages for white, Black, and Hispanic populations
# Add readable tract and county name columns using str_extract() or similar
tract_analysis <- get_acs(
geography = "tract",
variables = c(
White_Alone = "B03002_003",
Black_African_American = "B03002_004",
Hispanic_Latino = "B03002_012",
Total_Population = "B03002_001"
),
state = "54",
county = c(
"037",
"039",
"041"
),
year = 2023,
output = "wide"
)
tract_analysis <- tract_analysis %>%
mutate(census_tract = str_extract(NAME, "^[^;]+"),
county = str_extract(NAME, "(?<=;).*")
)
tract_analysis <- tract_analysis %>%
select(!"NAME")
tract_analysis <- tract_analysis %>%
mutate(
county = str_remove(county, "County; West Virginia"),
census_tract = str_remove(census_tract, "Census Tract ")
)
tract_analysis <- tract_analysis %>%
mutate(county = str_remove(county, " County"))
tract_analysis <- tract_analysis %>%
mutate(Per_White = White_AloneE / Total_PopulationE,
Per_Black = Black_African_AmericanE / Total_PopulationE,
Per_Hispanic = Hispanic_LatinoE / Total_PopulationE)
# Find the tract with the highest percentage of Hispanic/Latino residents
# Hint: use arrange() and slice() to get the top tract
highest_hispanic <- tract_analysis %>%
arrange(desc(Per_Hispanic)) %>%
slice(1:5)
# Calculate average demographics by county using group_by() and summarize()
county_demographics <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE)
)
# Show: number of tracts, average percentage for each racial/ethnic group
table <- tract_analysis %>%
group_by(county) %>%
summarize(
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(White_AloneE)/sum(Total_PopulationE),
Tracts = n()
)
# Create a nicely formatted table of your results using kable()
kable(table,
col.names = c("County", "Percent Black", "Percent White", "Percent Hispanic", "Number of Census Tracts"),
caption = "Demographic Information at County Level, West Virginia")
# Calculate MOE percentages for white, Black, and Hispanic variables
# Hint: use the same formula as before (margin/estimate * 100)
MOE_analysis <- tract_analysis %>%
mutate(WhiteMOE = (White_AloneM/White_AloneE)*100,
BlackMOE = (Black_African_AmericanM/Black_African_AmericanE)*100,
HispanicMOE = (Hispanic_LatinoM/Hispanic_LatinoE)*100
)
# Create a flag for tracts with high MOE on any demographic variable
# Use logical operators (| for OR) in an ifelse() statement
MOE_analysis <- MOE_analysis %>%
mutate(Quality = case_when(
WhiteMOE > 20 | BlackMOE > 10 | HispanicMOE >10 ~ "Very Low Quality",
WhiteMOE < 10 | BlackMOE < 10 | HispanicMOE < 10 ~ "Fine",
.default = "Low Quality"
))
# Create summary statistics showing how many tracts have data quality issues
MOE_analysis %>% count(Quality)
# Group tracts by whether they have high MOE issues
# Calculate average characteristics for each group:
# - population size, demographic percentages
# Use group_by() and summarize() to create this comparison
# Create a professional table showing the patterns
MOE_Table <- MOE_analysis %>%
group_by(Quality) %>%
summarize(average_population = mean(Total_PopulationE),
Per_Black = sum(Black_African_AmericanE)/sum(Total_PopulationE),
Per_White = sum(White_AloneE)/sum(Total_PopulationE),
Per_Hispanic = sum(Hispanic_LatinoE)/sum(Total_PopulationE))
# Create a summary table using your county reliability data
# Include: county name, median income, MOE percentage, reliability category
# Add a new column with algorithm recommendations using case_when():
# - High Confidence: "Safe for algorithmic decisions"
# - Moderate Confidence: "Use with caution - monitor outcomes"
# - Low Confidence: "Requires manual review or additional data"
# Format as a professional table with kable()
View(MOE_Table)
kable(MOE_Table) %>%
col.names = c("Quality Category", "Average Population", "Percent Black",
"Percent White", "Percent Hispanic"),
caption= c("Demographic Characteristics of Data Quality")
caption= c("Demographic Characteristics of Data Quality")
kable(MOE_Table,
col.names = c("Quality Category", "Average Population", "Percent Black", "Percent White", "Percent Hispanic"),
caption= c("Demographic Characteristics of Data Quality")
library(knitr)
library(knitr)
kable(MOE_Table,
col.names = c("Quality Category", "Average Population", "Percent Black", "Percent White", "Percent Hispanic"),
caption= "Demographic Characteristics of Data Quality")
View(MOE_analysis)
View(county_demographics)
View(data_working)
County_Reliability_Table <- data_working %>%
mutate(Algorithm_Rec = case_when(
INC_reliability = "High Confidence" ~ "Safe for algorithmic decisions",
INC_reliability = "Moderate Confidence" ~ "Use with caution - monitor outcomes",
INC_reliability = "Low Confidence" ~ "Requires manual review or additional data")
)
County_Reliability_Table <- data_working %>%
mutate(Algorithm_Rec = case_when(
INC_reliability == "High Confidence" ~ "Safe for algorithmic decisions",
INC_reliability == "Moderate Confidence" ~ "Use with caution - monitor outcomes",
INC_reliability == "Low Confidence" ~ "Requires manual review or additional data")
)
View(County_Reliability_Table)
County_Reliability_Table <- County_Reliability_Table %>%
select(new_name, median_hh_incomeE, INC_MOE_Per, INC_reliability, Algorithm_Rec)
Kable(County_Reliability_Table,
col.names = c("County Name", "Median Household Income", "Margin of Error", "Reliability", "Algorithmic Recommendation"),
caption = "Data Reliability and Recommendations for West Virginia County Median Income Data")
kable(County_Reliability_Table,
col.names = c("County Name", "Median Household Income", "Margin of Error", "Reliability", "Algorithmic Recommendation"),
caption = "Data Reliability and Recommendations for West Virginia County Median Income Data")
